<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yætzy</title>
    <link rel="icon" type="image/x-icon" href="./icons8-dice-six-32.png">
    <style>
        .seksjon1 {
            display: grid;
            grid-gap: 1vh;
            grid-template-columns: repeat(6, 4vh);
            place-content: center;
            visibility: hidden;
        }

        .seksjon2 {
            display: grid;
            grid-gap: 0vh;
            grid-template-columns: 2fr repeat(4, 1fr);
        }

        div {
            border: 0.1vh solid rgb(79, 79, 79);
            padding: 0.3vh;
        }

        .sentrering {
            display: grid;
            place-content: center;
        }

        .terningsvar,
        #antallkast {
            text-align: center;
            margin-bottom: 2vw;
        }

        #antallkast {
            background-color: rgb(158, 154, 154);
            border: none;
            border-radius: 40%;
        }

        .knappene {
            display: flex;
            justify-content: center;
            margin: 5vh 2vh 2vh;
            grid-gap: 0.6vh;
        }


        #reglene {
            border: 0.25vh navy solid;
            padding: 1vh;
            max-width: 33vh;

        }

        #ikkejukks {
            border: 0.4vh red solid;
            padding: 1.2vh;
            font-size: 3.2vh;
            font-weight: 900;
            max-width: 33vh;
        }

        .rad7,
        .rad18 {
            font-weight: 900;
        }

        #hvemspiller,
        #terningen {
            background-color: rgb(160, 160, 219);
            padding: 0.4vh;
            font-family: 'Times New Roman', Times, serif;
        }

        #hvemspiller:hover,
        #terningen:hover {
            background-color: rgb(140, 140, 198);
        }

        .objekt {
            border: none;
            grid-row-start: 2;
            grid-row-end: 3;
        }

        .hoved_seksjon {
            display: grid;
            grid-template-columns: auto auto auto;
            place-content: center;
            column-gap: 10vw;
            border: none;
        }

        .sideboks {
            margin-top: 70%;
        }
    </style>
</head>

<body>
    <div class="hoved_seksjon">
        <div class="objekt sideboks">
            <div id="reglene">
                <h2>Slik spiller du Yatzy 🎲</h2>
                <li>Trykk på hvem spiller for å starte</li>
                <li>Kast terningene</li>
                <li>Behold verdier ved å trykke på de</li>
                <li>Trykk på den ruten du vil legge de i</li>
                <li>Maks tre kast per runde</li>
                <li>Bonus ved 63 eller fler poeng</li>
            </div>
        </div>


        <div class="objekt">
            <nav class="knappene">
                <button id="hvemspiller">Hvem spiller?</button>
                <button id="terningen">Kast terningene</button>

            </nav>

            <main class="sentrering" id="test">
                <section class="seksjon1">
                    <div class="terningsvar" onclick="riktigKast(1)"></div>
                    <div class="terningsvar" onclick="riktigKast(2)"></div>
                    <div class="terningsvar" onclick="riktigKast(3)"></div>
                    <div class="terningsvar" onclick="riktigKast(4)"></div>
                    <div class="terningsvar" onclick="riktigKast(5)"></div>
                    <div id="antallkast"></div>
                </section>

                <section class="seksjon2">
                    <div><b>Deltagere</b></div>
                    <div class="deltagere" id="deltager1"></div>
                    <div class="deltagere" id="deltager2"></div>
                    <div class="deltagere" id="deltager3"></div>
                    <div class="deltagere" id="deltager4"></div>
                    <div>Enere</div>
                    <div class="rad1" onclick="sumEnTilSeks(1, 1)"></div>
                    <div class="rad1" onclick="sumEnTilSeks(1, 2)"></div>
                    <div class="rad1" onclick="sumEnTilSeks(1, 3)"></div>
                    <div class="rad1" onclick="sumEnTilSeks(1, 4)"></div>
                    <div>Toere</div>
                    <div class="rad2" onclick="sumEnTilSeks(2, 1)"></div>
                    <div class="rad2" onclick="sumEnTilSeks(2, 2)"></div>
                    <div class="rad2" onclick="sumEnTilSeks(2, 3)"></div>
                    <div class="rad2" onclick="sumEnTilSeks(2, 4)"></div>
                    <div>Treere</div>
                    <div class="rad3" onclick="sumEnTilSeks(3, 1)"></div>
                    <div class="rad3" onclick="sumEnTilSeks(3, 2)"></div>
                    <div class="rad3" onclick="sumEnTilSeks(3, 3)"></div>
                    <div class="rad3" onclick="sumEnTilSeks(3, 4)"></div>
                    <div>Firere</div>
                    <div class="rad4" onclick="sumEnTilSeks(4, 1)"></div>
                    <div class="rad4" onclick="sumEnTilSeks(4, 2)"></div>
                    <div class="rad4" onclick="sumEnTilSeks(4, 3)"></div>
                    <div class="rad4" onclick="sumEnTilSeks(4, 4)"></div>
                    <div>Femmere</div>
                    <div class="rad5" onclick="sumEnTilSeks(5, 1)"></div>
                    <div class="rad5" onclick="sumEnTilSeks(5, 2)"></div>
                    <div class="rad5" onclick="sumEnTilSeks(5, 3)"></div>
                    <div class="rad5" onclick="sumEnTilSeks(5, 4)"></div>
                    <div>Seksere</div>
                    <div class="rad6" onclick="sumEnTilSeks(6, 1)"></div>
                    <div class="rad6" onclick="sumEnTilSeks(6, 2)"></div>
                    <div class="rad6" onclick="sumEnTilSeks(6, 3)"></div>
                    <div class="rad6" onclick="sumEnTilSeks(6, 4)"></div>
                    <div><b>Sum</b></div>
                    <div class="rad7" onclick="forsteSum(7, 1)"></div>
                    <div class="rad7" onclick="forsteSum(7, 2)"></div>
                    <div class="rad7" onclick="forsteSum(7, 3)"></div>
                    <div class="rad7" onclick="forsteSum(7, 4)"></div>
                    <div><b>Bonus</b></div>
                    <div class="rad8"></div>
                    <div class="rad8"></div>
                    <div class="rad8"></div>
                    <div class="rad8"></div>
                    <div>Ett par</div>
                    <div class="rad9" onclick="etPar(9, 1)"></div>
                    <div class="rad9" onclick="etPar(9, 2)"></div>
                    <div class="rad9" onclick="etPar(9, 3)"></div>
                    <div class="rad9" onclick="etPar(9, 4)"></div>
                    <div>To par</div>
                    <div class="rad10" onclick="toPar(10, 1)"></div>
                    <div class="rad10" onclick="toPar(10, 2)"></div>
                    <div class="rad10" onclick="toPar(10, 3)"></div>
                    <div class="rad10" onclick="toPar(10, 4)"></div>
                    <div>Tre like</div>
                    <div class="rad11" onclick="antallLike(11, 1, 3)"></div>
                    <div class="rad11" onclick="antallLike(11, 2, 3)"></div>
                    <div class="rad11" onclick="antallLike(11, 3, 3)"></div>
                    <div class="rad11" onclick="antallLike(11, 4, 3)"></div>
                    <div>Fire like</div>
                    <div class="rad12" onclick="antallLike(12, 1, 4)"></div>
                    <div class="rad12" onclick="antallLike(12, 2, 4)"></div>
                    <div class="rad12" onclick="antallLike(12, 3, 4)"></div>
                    <div class="rad12" onclick="antallLike(12, 4, 4)"></div>
                    <div>Liten straight</div>
                    <div class="rad13" onclick="litenStorStraight(13, 1, 1)"></div>
                    <div class="rad13" onclick="litenStorStraight(13, 2, 1)"></div>
                    <div class="rad13" onclick="litenStorStraight(13, 3, 1)"></div>
                    <div class="rad13" onclick="litenStorStraight(13, 4, 1)"></div>
                    <div>Stor straight</div>
                    <div class="rad14" onclick="litenStorStraight(14, 1, 2)"></div>
                    <div class="rad14" onclick="litenStorStraight(14, 2, 2)"></div>
                    <div class="rad14" onclick="litenStorStraight(14, 3, 2)"></div>
                    <div class="rad14" onclick="litenStorStraight(14, 4, 2)"></div>
                    <div>Hus</div>
                    <div class="rad15" onclick="sumHus(15, 1)"></div>
                    <div class="rad15" onclick="sumHus(15, 2)"></div>
                    <div class="rad15" onclick="sumHus(15, 3)"></div>
                    <div class="rad15" onclick="sumHus(15, 4)"></div>
                    <div>Sjanse</div>
                    <div class="rad16" onclick="sjanse(16, 1)"></div>
                    <div class="rad16" onclick="sjanse(16, 2)"></div>
                    <div class="rad16" onclick="sjanse(16, 3)"></div>
                    <div class="rad16" onclick="sjanse(16, 4)"></div>
                    <div>Yatzy</div>
                    <div class="rad17" onclick="antallLike(17, 1, 5)"></div>
                    <div class="rad17" onclick="antallLike(17, 2, 5)"></div>
                    <div class="rad17" onclick="antallLike(17, 3, 5)"></div>
                    <div class="rad17" onclick="antallLike(17, 4, 5)"></div>
                    <div><b>Totalt</b></div>
                    <div class="rad18" onclick="totSum(18, 1)"></div>
                    <div class="rad18" onclick="totSum(18, 2)"></div>
                    <div class="rad18" onclick="totSum(18, 3)"></div>
                    <div class="rad18" onclick="totSum(18, 4)"></div>
                </section>
            </main>
        </div>


        <div class="objekt sideboks">
            <div id="ikkejukks">
                <p id="feilmelding"> Og husk, ingen juksing </p>
            </div>
        </div>
    </div>

    <script>
        var terningen = document.getElementById("terningen"); /*Kaster terninger*/
        var hvemSpiller = document.getElementById("hvemspiller"); /*Angir hvor mange og hvem som spiller*/

        var antallKast = document.getElementById("antallkast");

        var feilMelding = document.getElementById("feilmelding");

        var terningSvar = document.getElementsByClassName("terningsvar"); /*Klassen til terningene*/

        let seksjonArray = [
            document.getElementsByClassName("rad1"), //0
            document.getElementsByClassName("rad2"), //1 
            document.getElementsByClassName("rad3"), //2
            document.getElementsByClassName("rad4"), //3
            document.getElementsByClassName("rad5"), //4
            document.getElementsByClassName("rad6"), //5
            document.getElementsByClassName("rad7"), //6
            document.getElementsByClassName("rad8"),
            document.getElementsByClassName("rad9"),
            document.getElementsByClassName("rad10"),
            document.getElementsByClassName("rad11"),
            document.getElementsByClassName("rad12"),
            document.getElementsByClassName("rad13"),
            document.getElementsByClassName("rad14"),
            document.getElementsByClassName("rad15"),
            document.getElementsByClassName("rad16"),
            document.getElementsByClassName("rad17"),
            document.getElementsByClassName("rad18"),
        ]

        var deltagere = document.getElementsByClassName("deltagere");

        //Hvor mange og hvem spiller?
        let antallDeltagere = 0;
        function hvemHvorSpiller() {
            for (let i = 0; i < deltagere.length; i++) {
                deltagere[i].innerHTML = prompt("navn på spiller").substring(0, 2)
                if (deltagere[i].innerHTML !== "") {
                    antallDeltagere++;
                }
            }
        }
        hvemSpiller.onclick = hvemHvorSpiller;

        function terningReturn() {
            return Math.ceil(Math.random() * 6);
        }

        //varsler om hvor antall kast vises
        antallKast.style.visibility = "visible"
        antallKast.innerHTML = "her kommer antall kast"
        setTimeout(function () {
            antallKast.innerText = '';
        }, 1500);
        sumKast = 0;
        function kast() {
            document.getElementsByTagName("section")[0].style.visibility = "visible";
            if (sumKast == 3) { } // man får bare kaste tre ganger så må man plassere.
            else {
                for (let i = 0; i < terningSvar.length; i++) {
                    if (terningSvar[i].style.backgroundColor != "green") {
                        terningSvar[i].innerHTML = terningReturn();
                    }
                }
                sumKast += 1;
                antallKast.innerHTML = sumKast;
            }
        }
        terningen.onclick = kast;

        //Det som gjør grønn terning, her defineres fargen på terningen
        for (let i = 0; i < terningSvar.length; i++)
            terningSvar[i].style.backgroundColor = "white";

        function riktigKast(terningNr) {
            if (Number(antallKast.innerHTML) == 0) { // da skal funksjon ikke kjøres
            }
            else {
                if (terningSvar[terningNr - 1].style.backgroundColor == "white") {
                    terningSvar[terningNr - 1].style.backgroundColor = "green";
                }

                else if (terningSvar[terningNr - 1].style.backgroundColor == "green") {
                    terningSvar[terningNr - 1].style.backgroundColor = "white";
                }
            }
        }

        function resetKast() {
            for (let i = 0; i < terningSvar.length; i++) {
                terningSvar[i].style.backgroundColor = "white";
            }
            sumKast = 0;
            antallKast.innerHTML = 0;
        }

        function sumEnTilSeks(radNummer, kolonneNummer) { // funker for alle fre en til seks
            resultat = 0;
            antallGronne = 0;
            for (let i = 0; i < terningSvar.length; i++) {
                if (terningSvar[i].style.backgroundColor == "green") {
                    resultat += Number(terningSvar[i].innerHTML)
                    antallGronne++;
                }
                terningSvar[i].style.backgroundColor = "white";
            }
            if (resultat / antallGronne == radNummer || resultat == 0) {
                seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = resultat;
            }
            else {
                seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = 0;
                feilMelding.innerHTML = "Dette går ikke"
                setTimeout(function () {
                    feilMelding.innerText = 'Husk ingen juksing';
                }, 3000);
            }

            resetKast();
        }

        function forsteSum(radNummer, kolonneNummer) {
            sum = 0
            if (seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML > 0) {
            }
            else {
                for (let i = 0; i < 7; i++) {
                    sum += Number(seksjonArray[i][kolonneNummer - 1].innerHTML);
                }
                seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = sum;
                if (sum >= 63) {
                    seksjonArray[radNummer][kolonneNummer - 1].innerHTML = 50;
                }
                seksjonArray[radNummer][kolonneNummer - 1].innerHTML = 0;
            }
        }

        function etPar(radNummer, kolonneNummer) {
            resultat = 0;
            for (let i = 0; i < terningSvar.length; i++) {
                if (terningSvar[i].style.backgroundColor == "green") {
                    resultat = resultat + Number(terningSvar[i].innerHTML);
                }
                terningSvar[i].style.backgroundColor = "white";
                if (resultat / 2 == Number(terningSvar[i].innerHTML) || resultat == 0) {
                    seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = resultat;
                }
            }
            resetKast();
        }

        function toPar(radNummer, kolonneNummer) {
            let resultat = 0;
            let parArray = [];
            for (let i = 0; i < terningSvar.length; i++) {
                if (terningSvar[i].style.backgroundColor == "green") {
                    resultat = resultat + Number(terningSvar[i].innerHTML);
                    parArray.unshift(Number(terningSvar[i].innerHTML));
                }
                terningSvar[i].style.backgroundColor = "white";
            }

            seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = 0;

            for (let j = 0; j < parArray.length; j++) {
                if (resultat / 2 == Math.max(...parArray) + Math.min(...parArray)) {
                    seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = resultat;
                }
            }
            resetKast();
        }

        function sumHus(radNummer, kolonneNummer) {
            let resultat = 0;
            let parArray = [];
            let antallGronne = 0
            for (let i = 0; i < terningSvar.length; i++) {
                if (terningSvar[i].style.backgroundColor == "green") {
                    resultat += Number(terningSvar[i].innerHTML);
                    parArray.unshift(Number(terningSvar[i].innerHTML));
                    antallGronne++;
                }
                terningSvar[i].style.backgroundColor = "white";
            }
            parArray.sort();
            seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = 0;

            if (antallGronne == 5) {
                if (parArray[2] == parArray[3]) {
                    if (resultat / 2 == parArray[2] * 1.5 + parArray[1]) {
                        seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = resultat;
                    }
                }
                if (parArray[2] == parArray[1]) {
                    if (resultat / 2 == parArray[2] * 1.5 + parArray[3]) {
                        seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = resultat;
                    }
                }
            }
            resetKast();
        }

        function antallLike(radNummer, kolonneNummer, sumLike) {
            resultat = 0;
            antallGronne = 0;
            for (let i = 0; i < terningSvar.length; i++) {
                if (terningSvar[i].style.backgroundColor == "green") {
                    resultat += Number(terningSvar[i].innerHTML)
                    antallGronne++;
                }
                terningSvar[i].style.backgroundColor = "white";
            }

            for (let i = 0; i < terningSvar.length; i++) {
                if (antallGronne == sumLike || resultat == 0) {
                    if (resultat / sumLike == Number(terningSvar[i].innerHTML) || resultat == 0) {
                        if (sumLike == 5 && antallGronne == 5) {
                            resultat = 50;
                        }
                        seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = resultat;
                    }
                }
                else {
                    seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = 0;
                    feilMelding.innerHTML = "Du prøver og jukse igjen"
                    setTimeout(function () {
                        feilMelding.innerText = 'Husk ingen juksing';
                    }, 3000);
                }
            }
            resetKast();
        }

        function litenStorStraight(radNummer, kolonneNummer) {
            let svarArray = []
            for (let i = 0; i < terningSvar.length; i++) {
                if (terningSvar[i].style.backgroundColor == "green") {
                    svarArray.unshift(Number(terningSvar[i].innerHTML));
                }
            }
            seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = 0

            if (radNummer == 13) {
                if (svarArray.includes(1 && 2 && 3 && 4 && 5)) {
                    seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = 15;
                }
            }
            if (radNummer == 14) {
                if (svarArray.includes(2 && 3 && 4 && 5 && 6)) {
                    seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = 20;
                }
            }
            for (let i = 0; i < terningSvar.length; i++) {
                terningSvar[i].style.backgroundColor = "white";
            }
            resetKast();
        }

        function sjanse(radNummer, kolonneNummer) {
            resultat = 0;
            for (let i = 0; i < terningSvar.length; i++) {
                if (terningSvar[i].style.backgroundColor == "green") {
                    resultat += Number(terningSvar[i].innerHTML)
                }
                terningSvar[i].style.backgroundColor = "white";
            }
            seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = resultat
            resetKast();
        }

        let vinnerArray = []
        function totSum(radNummer, kolonneNummer) {
            sum = 0
            for (let i = 6; i < 17; i++) {
                sum += Number(seksjonArray[i][kolonneNummer - 1].innerHTML);
            }
            // if (seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML === "") { funker ikke lagrer ikke riktig verdi?
            vinnerArray.splice(kolonneNummer - 1, 0, seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML);
            //    }

            seksjonArray[radNummer - 1][kolonneNummer - 1].innerHTML = sum;
            resetKast();
            vinner();
        }


        function vinner() { //ANNONSERER VINNEREN når tot summene er fylt innn
            let nr1_poeng = 0;
            if (vinnerArray.length >= antallDeltagere.length || vinnerArray.length == 4) {
                nr1_poeng = Math.max(...vinnerArray);
                deltager_nr = vinnerArray.indexOf(String(nr1_poeng))

                if (deltagere[0 && 1 && 2 && 3].innerHTML === '') { //hvis du har spilt uten navn på alle plasser
                    alert("Vinneren er spiller nr." + (deltager_nr + 1) + " med " + nr1_poeng + " poeng")
                }
                else {
                    alert("Vinneren er " + deltagere[deltager_nr].innerHTML + " med " + nr1_poeng + " poeng")
                }
            }
        }

    </script>
</body>

</html>